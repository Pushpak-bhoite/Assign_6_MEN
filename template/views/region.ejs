<!DOCTYPE html>
<html lang="en">

<%- include('./partials/head') %>

    <body>
        <% let dUser; %>
            <% if (Sdata.frole==="Admin" ) { %>
                <% dUser="d-user" ; %>
                    <% } %>
                        <div class="wrapper <%=dUser%> " id="targetUser">
                            <%- include('./partials/sidebar.ejs')%>
                                <div class="main p-3">
                                    <!-- header  -->
                                    <%- include('./partials/header.ejs')%>

                                        <!-- ----------------------REGION--------------------- -->

                                        <!-- ----------------------REGION-form--------------------- -->
                                        <div class="container-fluid">
                                            <div class="row justify-content-center">
                                                <div
                                                    class="col-lg-8 col-md-10 col-sm-12 d-flex flex-column justify-content-center align-items-center">
                                                    <h3 class="mb-3 text-center">Region</h3>
                                                    <form action="/region" method="post"
                                                        class="d-flex flex-wrap gap-3 fs-5">
                                                        <div class="row">
                                                            <input type="hidden" name="userId" value="<%=Sdata._id %>">
                                                            <div class="col-md-3">
                                                                <label for="conName" class="form-label">Country</label>
                                                                <input type="text" name="regionCountry"
                                                                    class="form-control mb-3" required>
                                                            </div>
                                                            <div class="col-md-3">
                                                                <label for="sName" class="form-label">State</label>
                                                                <input type="text" name="regionState"
                                                                    class="form-control mb-3" required>
                                                            </div>
                                                            <div class="col-md-3">
                                                                <label for="cName" class="form-label">City</label>
                                                                <input type="text" name="regionCity"
                                                                    class="form-control mb-3" required>
                                                            </div>
                                                            <div class="col-md-3 align-self-end mb-3">
                                                                <button type="submit"
                                                                    class="btn btn-primary w-100 mt-md-4">Add</button>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- ----------------------REGION-Table--------------------- -->
                                        <div class="row" id="regionListUser">
                                            <div class="col-12 col-md-12 mx-auto">
                                                <!-- Your content goes here -->
                                            </div>

                                            <div class="col-12 col-md-6 d-flex">

                                            </div>
                                            <!-- Table Element -->
                                            <div class="card border-0 bg-dark">

                                                <div class="card-body table-responsive">
                                                    <table class="table table-dark">
                                                        <thead>
                                                            <tr>
                                                                <th scope="col">UserID</th>
                                                                <th scope="col">Country</th>
                                                                <th scope="col">State</th>
                                                                <th scope="col">City</th>
                                                                <th scope="col">Opration</th>
                                                            </tr>
                                                        </thead>
                                                        <tbody>
                                                            <!-- need to add users info via mongo db -->
                                                            <% if(locals.Rdata){ %>
                                                                <%Rdata.forEach((i)=>{ %>

                                                                    <tr>
                                                                        <% if(Sdata.frole ==='Admin' || (Sdata.frole ==='User' && Sdata._id.toString() == i.userId)){%>
                                                                        <td>
                                                                            <%=i.userId%>
                                                                        </td>
                                                                        <td>
                                                                            <%=i.regionCountry%>
                                                                        </td>
                                                                        <td>
                                                                            <%=i.regionState%>
                                                                        </td>
                                                                        <td>
                                                                            <%=i.regionCity%>
                                                                        </td>
                                                                        <td>
                                                                            <button type="button"
                                                                                class="btn btn-warning">Edit</button>
                                                                            <button type="button"
                                                                                class="btn btn-danger">Delete</button>
                                                                        </td>
                                                                        <% } %>
                                                                    </tr>
                                                                    <% }) %>
                                                                        <% } %>
                                                        </tbody>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>

                                </div>
                        </div>



                        <!-- Bootsatrp -->
                        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
                            integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
                            crossorigin="anonymous"></script>

                        <!-- jquery -->
                        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
                            integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
                            crossorigin="anonymous" referrerpolicy="no-referrer"></script>

                        <script>

                            $(document).ready(function () {

                                const hamburger = $("#toggle-btn");

                                $("#toggle-btn").click(function () {
                                    $("#sidebar").toggleClass("expand");
                                });

                                // $('.Uhide').hide();
                                $('.active').hide();
                                $('.in-active').hide();

                                $("#blocked").click(function () {
                                    $('.active').show();
                                    $('.in-active').hide();
                                });

                                $("#un-blocked").click(function () {
                                    $('.active').hide();
                                    $('.in-active').show();
                                });

                            });

                        </script>

    </body>

</html>